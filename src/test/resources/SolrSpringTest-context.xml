<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
            http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
            http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">

    <camelContext xmlns="http://camel.apache.org/schema/spring">
        <route>
            <from uri="direct:start"/>

            <split>
                <xpath>/bookstore/book</xpath>

                <convertBodyTo type="java.lang.String"/>

                <setHeader headerName="solr.field.id">
                    <xpath resultType="java.lang.String">//title/text()</xpath>
                </setHeader>

                <setHeader headerName="solr.field.title">
                    <xpath resultType="java.lang.String">//title/text()</xpath>
                </setHeader>

                <!-- Multi-valued field    -->
                <setHeader headerName="solr.field.cat">
                    <groovy>
                        def book = new XmlParser().parseText(request.body)
                        book.cat.collect{ it.text() } as String[]
                    </groovy>
                </setHeader>

                <to uri="solr://localhost:8899/solr"/>
            </split>

            <setHeader headerName="solr.operation">
                <constant>COMMIT</constant>
            </setHeader>
            <to uri="solr://localhost:8899/solr"/>
        </route>
    </camelContext>
</beans>